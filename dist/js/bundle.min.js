!function e(o,t,n){function r(s,u){if(!t[s]){if(!o[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var a=t[s]={exports:{}};o[s][0].call(a.exports,function(e){var t=o[s][1][e];return r(t?t:e)},a,a.exports,e,o,t,n)}return t[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,o,t){o.exports=["$scope","title","batApiSrv","objects","type",function(e,o,t,n,r){e.title=o,e.room="type",e.type=r,e.items=t.getLiveList(n),e.$on("$destroy",function(){t.clearObjects()})}]},{}],2:[function(e,o,t){o.exports=["$scope","floor","rooms","type","helperObjectService","batApiSrv","objects",function(e,o,t,n,r,i,s){e.title=o.name,o.house_id?(e.floorObj=o,e.backUrl="#/house/"+o.house_id):e.backUrl="#/tree",e.zones=t,e.room="floor",e.zone="rooms",e.items=i.getLiveList(s),e.$on("$destroy",function(){i.clearObjects()}),e.treeConfig={handle:".my-handle",onEnd:function(e){var o=e.models;r.reorder(o,"ap").then(function(){},function(){})}}}]},{}],3:[function(e,o,t){"use strict";o.exports=["$scope","batApiSrv","$http","WeatherIconService","AuthentificationService","objects","type","title","CookiesService",function(e,o,t,n,r,i,s,u,c){e.hour=null,e.day=null,e.AuthentificationService=r,e.title=u,e.type=s,e.room="home";var a=c.get("language")?c.get("language"):"ro",l=function(){e.day=moment().locale(a).format("dddd Do MMM YYYY"),e.hour=moment().locale(a).format("HH : mm")},d=function(){setTimeout(function(){l(),d()},100)};d(),t.get("/helpers/weather",{}).success(function(o){e.weather={},e.weather.description=o.current.skytext,e.weather.icon=o.current.imageUrl,e.weather.temperature=o.current.temperature,e.weather.humidity=o.current.humidity,e.weather.wind=o.current.winddisplay}).error(function(e){console.log(e)}),e.items=o.getLiveList(i),e.removeFavorite=function(o){var t=_.findLastIndex(e.items,{BMSID:o.BMSID});e.items.splice(t,1)},e.logOut=function(){o.clearObjects(),r.logout()},e.$on("$destroy",function(){o.clearObjects()})}]},{}],4:[function(e,o,t){o.exports=["$scope","house","floors","type","helperObjectService","objects","batApiSrv",function(e,o,t,n,r,i,s){e.title=o.name,e.backUrl="#/tree",e.zones=t,e.zone="floors",e.type=n,e.room="house",e.items=s.getLiveList(i),e.$on("$destroy",function(){s.clearObjects()}),e.treeConfig={handle:".my-handle",onEnd:function(e){var o=e.models;r.reorder(o,"house").then(function(){},function(){})}}}]},{}],5:[function(e,o,t){"use strict";var n=angular.module("arena");n.controller("loginCtrl",e("./loginCtrl")),n.controller("homeCtrl",e("./homeCtrl")),n.controller("floorCtrl",e("./floorCtrl")),n.controller("roomCtrl",e("./roomCtrl")),n.controller("houseCtrl",e("./houseCtrl")),n.controller("treeCtrl",e("./treeCtrl")),n.controller("settingsCtrl",e("./settingsCtrl")),n.controller("wizzardCtrl",e("./wizzardCtrl")),n.controller("typeCtrl",e("./typeCtrl")),n.controller("apCtrl",e("./apCtrl")),n.controller("sessionsCtrl",e("./sessionsCtrl")),n.controller("usersCtrl",e("./wizzard/usersCtrl")),n.controller("objectsToRoomsCtrl",e("./wizzard/objectsToRoomsCtrl")),n.controller("roomsToHouseCtrl",e("./wizzard/roomsToHouseCtrl")),n.controller("objectsControllsCtrl",e("./wizzard/objectsControllsCtrl")),n.controller("templatesCtrl",e("./wizzard/templatesCtrl")),n.controller("objectsToTemplateCtrl",e("./wizzard/objectsToTemplateCtrl"))},{"./apCtrl":1,"./floorCtrl":2,"./homeCtrl":3,"./houseCtrl":4,"./loginCtrl":6,"./roomCtrl":7,"./sessionsCtrl":8,"./settingsCtrl":9,"./treeCtrl":10,"./typeCtrl":11,"./wizzard/objectsControllsCtrl":13,"./wizzard/objectsToRoomsCtrl":14,"./wizzard/objectsToTemplateCtrl":15,"./wizzard/roomsToHouseCtrl":16,"./wizzard/templatesCtrl":17,"./wizzard/usersCtrl":18,"./wizzardCtrl":12}],6:[function(e,o,t){"use strict";o.exports=["$scope","AuthentificationService","$location","$window",function(e,o,t,n){e.login=function(r){r.$valid&&o.login(e.credentials).then(function(){"admin@admin.com"==e.credentials.name?t.path("/wizzard/users"):n.location.href="#/start"},function(){n.location.href="#/login"})}}]},{}],7:[function(e,o,t){o.exports=["$scope","room","type","typeId","batApiSrv","objects","$routeParams",function(e,o,t,n,r,i,s){o.floor_id?e.backUrl="#/floor/"+o.floor_id:e.backUrl="#/tree",e.baseUrl="#/room/"+o.id,e.title=o.name,e.type=t,e.typeId=n,e.room="room",s.q?e.checked=!0:e.checked=!1,e.toggle=function(){e.checked=!e.checked},e.items=r.getLiveList(i),e.$on("$destroy",function(){r.clearObjects()})}]},{}],8:[function(e,o,t){"use strict";o.exports=["$scope","AuthentificationService","$location","$window",function(e,o,t,n){e.users=["ap7@newton.direct","ap8@newton.direct","ap9@newton.direct","ap10@newton.direct","ap11@newton.direct","ap12@newton.direct"],e.loginAs=function(r){e.credentials={},e.credentials.name=r,e.credentials.password="newton",o.login(e.credentials).then(function(){"admin@admin.com"==e.credentials.name?t.path("/wizzard/users"):n.location.href="#/start"},function(){n.location.href="#/login"})}}]},{}],9:[function(e,o,t){o.exports=["$scope","$http","$window",function(e,o,t){e.resetModules=function(){e.isLoading=!0,ModulesQueryBuilder.clearDB().then(function(o){ZonesQueryBuilder.clearDB().then(function(o){e.isLoading=!1})})},o.get("/api/getWordsConfig").success(function(o){e.items=o}),e.save=function(n){if(n.$valid){var r={};_.each(e.items,function(e,o){r[o]=n[o].$modelValue}),o.post("/api/setWordsConfig",{json:r}).success(function(e){t.location.reload()})}}}]},{}],10:[function(e,o,t){o.exports=["$scope","items","type","title","zone","helperObjectService","objects","batApiSrv",function(e,o,t,n,r,i,s,u){e.title=n,e.type=t,e.zones=o,e.zone=r,e.items=u.getLiveList(s),e.room="tree",e.$on("$destroy",function(){u.clearObjects()}),e.treeConfig={handle:".my-handle",onEnd:function(o){var t=o.models;i.reorder(t,e.type).then(function(e){},function(){})}}}]},{}],11:[function(e,o,t){o.exports=["$scope","title","type","batApiSrv","objects","zones","typeId","routes","ObjectIconService","$routeParams",function(e,o,t,n,r,i,s,u,c,a){e.title=o,e.type=t,e.room="type",e.ObjectIconService=c,e.items=n.getLiveList(r),e.zones=i,e.routes=u,e.baseUrl="#/type/"+s,a.q?e.checked=!0:e.checked=!1,e.toggle=function(){e.checked=!e.checked},e.$on("$destroy",function(){n.clearObjects()}),console.log()}]},{}],12:[function(e,o,t){o.exports=["$scope","UsersQueryService","HouseQueryService","FloorQueryService","RoomQueryService","ObjectQueryService","CookiesService","ToastService","$location","ObjectTemplateService","$window","AuthentificationService","$route","$q","$http",function(e,o,t,n,r,i,s,u,c,a,l,d,f,m,h){e.types=[{key:"ap",value:"Apartment"},{key:"house",value:"House"},{key:"complex",value:"House complex"}],e.languages=[{key:"en",value:"English"},{key:"ro",value:"Romana"},{key:"fr",value:"Français"}],e.mainConfig={handle:".drag-handle",group:"bar"},e.goToStep=function(t){switch(t){case 0:o.all().then(function(o){e.users=o,console.log(e.users)}),e.stepZero=!0,e.stepOne=!1,e.stepTwo=!1,e.stepThree=!1;break;case 1:if(e.type){var n=_.findLastIndex(e.types,{key:e.type});e.selectedType=e.types[n]}if(e.language){var n=_.findLastIndex(e.languages,{key:e.language});e.selectedLanguage=e.languages[n]}e.stepZero=!1,e.stepOne=!0,e.stepTwo=!1,e.stepThree=!1;break;case 2:e.configTree(e.type),e.stepZero=!1,e.stepOne=!1,e.stepTwo=!0,e.stepThree=!1;break;case 3:e.configTree(e.type),e.stepZero=!1,e.stepOne=!1,e.stepTwo=!1,e.stepThree=!0,i.dbObjects().then(function(o){var t=o;i.all().then(function(o){_.each(o,function(e){if(e){var o=_.where(t,{BMSID:e.BMSID});if(o.length){var n=_.findLastIndex(t,{BMSID:o[0].BMSID});t.splice(n,1)}}}),e.modules=_.groupBy(t,function(e){return e.HAModuleName})})},function(){console.log("no connection")})}},e.configTree=function(o){switch(e.houses=[],e.floors=[],e.rooms=[],o){case"ap":e.rooms=[],r.findByFloorId().then(function(o){_.each(o,function(o){o.eachConfig={handle:".drag-handle",group:"bar",onAdd:function(e){i.insert(e.model,o.id).then(function(e){})},onRemove:function(e){i["delete"](e.model.BMSID).then(function(e){})}},o.objects=[],e.rooms.push(o),e.addObjects(o)})});break;case"house":e.floors=[],n.findByHouseId().then(function(o){_.each(o,function(o){o.rooms=[],e.floors.push(o),e.addRooms(o)})});break;case"complex":e.houses=[],t.all().then(function(o){var t=o;_.each(t,function(o){o.floors=[],e.houses.push(o),e.addFloors(o)})})}},e.type=s.get("type"),e.language=s.get("language"),e.goToApp=function(){l.location.href="#/start"},e.saveDB=function(){m.all([t.all(),n.all(),r.all(),i.all()]).then(function(o){var t={};t.houses=o[0],t.floors=o[1],t.rooms=o[2],t.objects=o[3],t.type=e.type,t.language=e.language,h.post("/api/saveDb",{user:"user@user.com",db:JSON.stringify(t)}).success(function(e){console.log(e)}).error(function(e){console.log(e)})})},e.goToStep(0),e.type||e.goToStep(3),e.clearDbObjects=function(){i.dbObjectsClear().then(function(e){l.location.reload()})},e.logout=function(){d.logout()},e.deleteObjectFromRoom=function(e){i["delete"](e.BMSID).then(function(e){f.reload()})},e.saveConfig=function(o){if(o.$valid){var u=!1;e.type&&e.type!=e.selectedType.key&&(u=!0),e.type=s.put("type",e.selectedType.key),e.language=s.put("language",e.selectedLanguage.key),u?m.all([t.clear(),n.clear(),r.clear(),i.clear()]).then(function(o){e.goToStep(2)}):e.goToStep(2)}},e.addFloors=function(o){n.findByHouseId(o.id).then(function(t){_.each(t,function(t){t.rooms=[],o.floors.push(t),e.addRooms(t)})})},e.addRooms=function(o){r.findByFloorId(o.id).then(function(t){_.each(t,function(t){t.objects=[],t.eachConfig={handle:".drag-handle",group:"bar",onAdd:function(e){i.insert(e.model,t.id).then(function(e){})},onRemove:function(e){i["delete"](e.model.BMSID).then(function(e){})}},o.rooms.push(t),e.addObjects(t)})})},e.addObjects=function(e){i.findByRoomId(e.id).then(function(o){_.each(o,function(o){e.objects.push(o)})})},e.apInsertRoom=function(o){o.$valid&&r.insertApRoom(e.apRoomName).then(function(o){e.rooms.push(o),e.apRoomName=""},function(){u.create("A room with the same name already exists","warning")})},e.apDeleteRoom=function(o){r["delete"](o).then(function(t){var n=_.findLastIndex(e.rooms,{id:o});e.rooms.splice(n,1)},function(){u.create("This room contains objects, Please clear the room before deleting it","warning")})},e.houseInsertFloor=function(o){o.$valid&&n.insertHouseFloor(e.houseFloorName).then(function(o){o.rooms=[],e.floors.push(o),e.houseFloorName=""},function(){u.create("A floor with the same name already exists","warning")})},e.houseInsertRoom=function(o){o.$valid&&r.insertRoom(e.houseRoomName,e.houseFloor.id).then(function(o){var t=_.findLastIndex(e.floors,{id:e.houseFloor.id});e.floors[t].rooms.push(o),e.houseRoomName="",e.houseFloor={}},function(){u.create("A room with the same name already exists in the selected floor","warning")})},e.houseDeleteFloor=function(o){n["delete"](o).then(function(t){var n=_.findLastIndex(e.floors,{id:o});e.floors.splice(n,1)},function(){u.create("This floor contains rooms, Please clear the floor befeore deleting it","warning")})},e.houseDeleteRoom=function(o,t){r["delete"](o).then(function(n){var r=_.findLastIndex(e.floors,{id:t}),i=e.floors[r].rooms,r=_.findLastIndex(i,{id:o});i.splice(r,1)},function(){u.create("This room contains objects, Please clear the room before deleting it","warning")})},e.complexInsertHouse=function(o){o.$valid&&t.insertComplexHouse(e.complexHouseName).then(function(o){o.floors=[],e.houses.push(o),e.complexHouseName=""},function(){u.create("A house with the same name already exists","warning")})},e.complexInsertFloor=function(o){o.$valid&&n.insertComplexFloor(e.complexFloorName,e.complexHouse.id).then(function(o){var t=_.findLastIndex(e.houses,{id:e.complexHouse.id});o.rooms=[],e.houses[t].floors.push(o),e.complexFloorName="",e.complexHouse={}},function(){u.create("A floor with the same name already exists in the selected house","warning")})},e.complexInsertRoom=function(o){o.$valid&&r.insertRoom(e.complexRoomName,e.complexFloor.id).then(function(o){var t=_.findLastIndex(e.houses,{id:e.complexRoomHouse.id}),n=e.houses[t].floors,t=_.findLastIndex(n,{id:e.complexFloor.id}),r=n[t].rooms;r.push(o),e.complexRoomHouse={},e.complexFloor={},e.complexRoomName=""},function(){u.create("A room with the same name already exists in the selected floor","warning")})},e.complexDeleteHouse=function(o){t["delete"](o).then(function(t){var n=_.findLastIndex(e.houses,{id:o});e.houses.splice(n,1)},function(){u.create("This house contains floors, Please clear the house befeore deleting it","warning")})},e.complexDeleteFloor=function(o,t){n["delete"](o).then(function(n){var r=_.findLastIndex(e.houses,{id:t}),i=e.houses[r].floors,r=_.findLastIndex(i,{id:o});i.splice(r,1)},function(){u.create("This floor contains rooms, Please clear the floor befeore deleting it","warning")})},e.complexDeleteRoom=function(o,t,n){r["delete"](o).then(function(r){var i=_.findLastIndex(e.houses,{id:n}),s=e.houses[i].floors,i=_.findLastIndex(s,{id:t}),u=s[i].rooms,i=_.findLastIndex(u,{id:o});u.splice(i,1)},function(){u.create("This room contains objects, Please clear the room before deleting it","warning")})}}]},{}],13:[function(e,o,t){o.exports=["$scope","$http","user","items","$location","ObjectFactory",function(e,o,t,n,r,i){e.items=n,e.goToUsers=function(){r.path("/wizzard/users")},e.goToRoomsToHouse=function(){r.path("wizzard/rooms-to-house/"+t.id+"/"+t.type)},e.goToObjectsToRooms=function(){r.path("wizzard/objects-to-rooms/"+t.id+"/"+t.type)},e.goToObjectsToControlls=function(){$route.reload()},e.user=t,e.deleteObject=function(e,o){i["delete"](o.id).then(function(){var t=_.findLastIndex(e,{id:o.id});e.splice(t,1)})}}]},{}],14:[function(e,o,t){o.exports=["$scope","$http","user","objects","$location","items","ObjectFactory","$route",function(e,o,t,n,r,i,s,u){e.goToUsers=function(){r.path("/wizzard/users")},e.goToRoomsToHouse=function(){r.path("wizzard/rooms-to-house/"+t.id+"/"+t.type)},e.goToObjectsToRooms=function(){u.reload()},e.goToObjectsToControlls=function(){r.path("wizzard/objects-controlls/"+t.id+"/"+t.type)},e.user=t,e.modules=_.groupBy(n,function(e){return e.HAModuleId}),e.items=i,e.deleteObject=function(e,o){s["delete"](o.id).then(function(){var t=_.findLastIndex(e,{id:o.id});e.splice(t,1)})}}]},{}],15:[function(e,o,t){o.exports=["$scope","$http","template","$location","$route",function(e,o,t,n,r){e.goToUsers=function(){n.path("/wizzard/users")},e.goToTemplates=function(){n.path("/wizzard/templates")},e.goToObjectsToTemplate=function(){r.reload()},e.template=t,e.templates=JSON.parse(t.template),e.addObject=function(){console.log("add")},e.addObjectToApRoom=function(e){console.log(e)}}]},{}],16:[function(e,o,t){o.exports=["$scope","$http","ToastService","$location","user","items","ObjectIconService","$route","RoomFactory","FloorFactory","HouseFactory",function(e,o,t,n,r,i,s,u,c,a,l){e.ObjectIconService=s,e.goToUsers=function(){n.path("/wizzard/users")},e.goToRoomsToHouse=function(){u.reload()},e.goToObjectsToRooms=function(){n.path("wizzard/objects-to-rooms/"+r.id+"/"+r.type)},e.goToObjectsToControlls=function(){n.path("wizzard/objects-controlls/"+r.id+"/"+r.type)},e.user=r,e.items=i,e.addApRoom=function(){void 0!=e.roomName&&(e.room={},e.room.name=e.roomName,e.room.user_id=e.user.id,e.room.icon_id=e.roomIcon.id,e.room.floor_id=0,c.create(e.room).then(function(o){e.room.id=o,e.items.rooms.push(e.room),e.room={},e.roomIcon=null,e.roomName=null}))},e.deleteApRoom=function(o){c["delete"]({room_id:o.id,user_id:e.user.id}).then(function(){var t=_.findLastIndex(e.items.rooms,{id:o.id});e.items.rooms.splice(t,1)})},e.addHouseFloor=function(){e.floor={},void 0!=e.floorName&&(e.floor.name=e.floorName,e.floor.user_id=e.user.id,e.floor.icon_id=e.floorIcon.id,a.create(e.floor).then(function(o){e.floor.id=o,e.floor.rooms=[],e.items.floors.push(e.floor),e.floor={},e.floorIcon=null,e.floorName=null}))},e.deleteHouseFloor=function(o){a["delete"]({floor_id:o.id,user_id:e.user.id}).then(function(){var t=_.findLastIndex(e.items.floors,{id:o.id});e.items.floors.splice(t,1)})},e.addHouseRoom=function(){e.room={},void 0!=e.roomName&&(e.room.name=e.roomName,e.room.user_id=e.user.id,e.room.floor_id=e.floor.id,e.room.icon_id=e.roomIcon.id,c.create(e.room).then(function(o){e.room.id=o;var t=_.findLastIndex(e.items.floors,{id:e.floor.id});e.items.floors[t].rooms.push(e.room),e.floor={},e.room={},e.roomName=null,e.roomIcon=null}))},e.deleteHouseRoom=function(o,t){c["delete"]({room_id:t.id,user_id:e.user.id}).then(function(){var n=_.findLastIndex(e.items.floors,{id:o.id}),r=_.findLastIndex(e.items.floors[n].rooms,{id:t.id});e.items.floors[n].rooms.splice(r,1)})},e.addComplexHouse=function(){e.house={},void 0!=e.houseName&&(e.house.name=e.houseName,e.house.user_id=e.user.id,e.house.icon_id=e.houseIcon.id,l.create(e.house).then(function(o){e.house.id=o,e.house.floors=[],e.items.houses.push(e.house),e.house={},e.houseName=null,e.houseIcon=null}))},e.deleteComplexHouse=function(o){l["delete"]({house_id:o.id,user_id:e.user.id}).then(function(){var t=_.findLastIndex(e.items.houses,{id:o.id});e.items.houses.splice(t,1)})},e.addComplexFloor=function(){e.floor={},void 0!=e.floorName&&(e.floor.name=e.floorName,e.floor.user_id=e.user.id,e.floor.house_id=e.house.id,e.floor.icon_id=e.floorIcon.id,a.create(e.floor).then(function(o){e.floor.id=o,e.floor.rooms=[];var t=_.findLastIndex(e.items.houses,{id:e.house.id});e.items.houses[t].floors.push(e.floor),e.house={},e.floor={},e.floorName=null,e.floorIcon=null}))},e.deleteComplexFloor=function(o,t){a["delete"]({floor_id:t.id,user_id:e.user.id}).then(function(){var n=_.findLastIndex(e.items.houses,{id:o.id}),r=_.findLastIndex(e.items.houses[n].floors,{id:t.id});e.items.houses[n].floors.splice(r,1)})},e.addComplexRoom=function(){e.room={},void 0!=e.roomName&&(e.room.name=e.roomName,e.room.user_id=e.user.id,e.room.floor_id=e.floor.id,e.room.icon_id=e.roomIcon.id,c.create(e.room).then(function(o){e.room.id=o;var t=_.findLastIndex(e.items.houses,{id:e.house.id}),n=_.findLastIndex(e.items.houses[t].floors,{id:e.floor.id});e.items.houses[t].floors[n].rooms.push(e.room),e.house={},e.floor={},e.room={},e.roomName=null,e.roomIcon=null}))},e.deleteComplexRoom=function(o,t,n){c["delete"]({room_id:n.id,user_id:e.user.id}).then(function(){var r=_.findLastIndex(e.items.houses,{id:o.id}),i=_.findLastIndex(e.items.houses[r].floors,{id:t.id}),s=_.findLastIndex(e.items.houses[r].floors[i].room,{id:n.id});e.items.houses[r].floors[i].rooms.splice(s,1)})}}]},{}],17:[function(e,o,t){o.exports=["$scope","ToastService","$location","$http","templates","$route","ObjectIconService",function(e,o,t,n,r,i,s){e.ObjectIconService=s,e.goToUsers=function(e){t.path("wizzard/users")},e.goToTemplates=function(){i.reload()},e.goToObjectsToTemplate=function(e){t.path("wizzard/objects-to-template/"+e.id)},e.types=[{key:"ap",value:"Apartment"},{key:"house",value:"House"},{key:"complex",value:"House complex"}],e.templates=r,e.template={},e.done=!1,e.saveTemplate=function(t){if(t.$valid){var r={};"ap"==e.template.type&&(r.rooms=e.rooms,r.objects=[]),"house"==e.template.type&&(r.floors=e.floors,r.objects=[]),"complex"==e.template.type&&(r.houses=e.houses,r.objects=[]),e.template.template=JSON.stringify(r),e.template.id?n.put("/api/templates/"+e.template.id,{template:e.template}).success(function(e){i.reload()}).error(function(e){o.create(e,"danger")}):n.post("/api/templates",{template:e.template}).success(function(o){e.template.id=o.id,e.templates.push(e.template),e.template={},e.done=!1}).error(function(e){o.create(e,"danger")})}},e.editTemplate=function(t){n.get("/api/templates/"+t.id).success(function(o){e.template=o,console.log(o),"ap"==o.type&&(e.rooms=JSON.parse(o.template).rooms),"house"==o.type&&(e.floors=JSON.parse(o.template).floors),"complex"==o.type&&(e.houses=JSON.parse(o.template).houses)}).error(function(e){o.create(e,"danger")})},e.removeTemplate=function(t){n["delete"]("/api/templates/"+t.id).success(function(n){var r=_.findLastIndex(e.templates,{id:t.id});e.templates.splice(r,1),o.create("Successfully deleted","success")}).error(function(e){o.create(e,"danger")})},e.rooms=[],e.addApRoom=function(){if(void 0!=e.roomName){var t=_.findLastIndex(e.rooms,{name:e.roomName});"-1"==t?(e.room={},e.room.name=e.roomName,e.room.icon_id=e.roomIcon.id,e.room.objects=[],e.rooms.push(e.room),e.room={},e.roomName=null,e.roomIcon=null):o.create("Room already exists","danger")}},e.deleteApRoom=function(o){var t=_.findLastIndex(e.rooms,{name:o.name});e.rooms.splice(t,1)},e.floors=[],e.addHouseFloor=function(){if(e.floor={},void 0!=e.floorName){var t=_.findLastIndex(e.floors,{name:e.floorName});"-1"==t?(e.floor.name=e.floorName,e.floor.icon_id=e.floorIcon.id,e.floor.objects=[],e.floor.rooms=[],e.floors.push(e.floor),e.floor={},e.floorName=null,e.floorIcon=null):o.create("Floor already exists","danger")}},e.deleteHouseFloor=function(o){var t=_.findLastIndex(e.floors,{name:o.name});e.floors.splice(t,1)},e.addHouseRoom=function(){if(e.room={},void 0!=e.roomName){var t=_.findLastIndex(e.floors,{name:e.floor.name}),n=_.findLastIndex(e.floors[t].rooms,{name:e.roomName});if("-1"==n){e.room.name=e.roomName,e.room.icon_id=e.roomIcon.id,e.room.objects=[];var t=_.findLastIndex(e.floors,{name:e.floor.name});e.floors[t].rooms.push(e.room),e.floor={},e.room={},e.roomName=null,e.roomIcon=null}else o.create("Room already exists","danger")}},e.deleteHouseRoom=function(o,t){var n=_.findLastIndex(e.floors,{name:o.name}),r=_.findLastIndex(e.floors[n].rooms,{name:t.name});e.floors[n].rooms.splice(r,1)},e.houses=[],e.addComplexHouse=function(){if(e.house={},void 0!=e.houseName){var t=_.findLastIndex(e.houses,{name:e.houseName});"-1"==t?(e.house.name=e.houseName,e.house.icon_id=e.houseIcon.id,e.house.floors=[],e.house.objects=[],e.houses.push(e.house),e.house={},e.houseName=null,e.houseIcon=null):o.create("House already exists","danger")}},e.deleteComplexHouse=function(o){var t=_.findLastIndex(e.houses,{name:o.name});e.houses.splice(t,1)},e.addComplexFloor=function(){if(e.floor={},void 0!=e.floorName){var t=_.findLastIndex(e.houses,{name:e.house.name}),n=_.findLastIndex(e.houses[t].floors,{name:e.floorName});if("-1"==n){e.floor.name=e.floorName,e.floor.icon_id=e.floorIcon.id,e.floor.rooms=[],e.floor.objects=[];var t=_.findLastIndex(e.houses,{name:e.house.name});e.houses[t].floors.push(e.floor),e.house={},e.floor={},e.floorName=null,e.floorIcon=null}else o.create("Floor already exists","danger")}},e.deleteComplexFloor=function(o,t){var n=_.findLastIndex(e.houses,{name:o.name}),r=_.findLastIndex(e.houses[n].floors,{name:t.name});e.houses[n].floors.splice(r,1)},e.addComplexRoom=function(){if(e.room={},void 0!=e.roomName){var t=_.findLastIndex(e.houses,{name:e.house.name}),n=_.findLastIndex(e.houses[t].floors,{name:e.floor.name}),r=_.findLastIndex(e.houses[t].floors[n].rooms,{name:e.roomName});if("-1"==r){e.room.name=e.roomName,e.room.icon_id=e.roomIcon.id,e.room.objects=[];var t=_.findLastIndex(e.houses,{name:e.house.name}),n=_.findLastIndex(e.houses[t].floors,{name:e.floor.name});e.houses[t].floors[n].rooms.push(e.room),e.house={},e.floor={},e.room={},e.roomName=null,e.roomIcon=null}else o.create("Room already exists","danger")}},e.deleteComplexRoom=function(o,t,n){var r=_.findLastIndex(e.houses,{name:o.name}),i=_.findLastIndex(e.houses[r].floors,{name:t.name}),s=_.findLastIndex(e.houses[r].floors[i].room,{name:n.name});e.houses[r].floors[i].rooms.splice(s,1)}}]},{}],18:[function(e,o,t){o.exports=["$scope","ToastService","$location","$http","users","$route","UserFactory","HouseFactory","FloorFactory","RoomFactory","ObjectFactory","$q","helperObjectService","ItemFactory",function(e,o,t,n,r,i,s,u,c,a,l,d,f,m){e.goToRoomsToHouse=function(e){t.path("wizzard/rooms-to-house/"+e.id+"/"+e.type)},e.goToObjectsToRooms=function(e){t.path("wizzard/objects-to-rooms/"+e.id+"/"+e.type)},e.goToObjectsToControlls=function(e){t.path("wizzard/objects-controlls/"+e.id+"/"+e.type)},e.goToTemplates=function(e){t.path("wizzard/templates")},e.goToUsers=function(e){i.reload()},e.types=[{key:"ap",value:"Apartment"},{key:"house",value:"House"},{key:"complex",value:"House complex"}],e.languages=[{key:"en",value:"English"},{key:"ro",value:"Romana"},{key:"fr",value:"Français"}],e.users=r,e.user={},e.saveUser=function(o){o.$valid&&s.create(e.user).then(function(o){e.user.id=o,e.users.push(e.user),e.user={}})},e.cloneUser=function(e){if(e.$valid){var o=e.cloneid.$modelValue,t=e.userid.$modelValue;m.deleteApTree(t).then(function(){m.getApTree(o).then(function(e){l.createAll(e.objects,t).then(function(){a.createAll(e.rooms,t).then(function(e){})})})})}},e.removeUser=function(t){s["delete"](t.id).then(function(){var n=_.findLastIndex(e.users,{id:t.id});e.users.splice(n,1),o.create("Successfully deleted","success")})}}]},{}],19:[function(e,o,t){"use strict";o.exports=["ObjectTemplateService","ObjectIconService","ToastService","ObjectFactory","$route",function(e,o,t,n,r){return{restrict:"E",templateUrl:"views/directives/admin-add-object-item.html",replace:!0,scope:{house:"@house",floor:"@floor",room:"@room",user:"@user"},link:function(i){i.object={},i.ObjectTemplateService=e,i.ObjectIconService=o,i.nameEditorEnabled=!1,i.enableNameEditor=function(){i.object.category&&(i.object.template_id&&(i.template=e.getTemplate(i.object.category,i.object.template_id)),i.object.icon_id&&(i.icon=o.getIcon(i.object.category,i.object.icon_id))),i.nameEditorEnabled=!0},i.disableNameEditor=function(){i.nameEditorEnabled=!1},i.saveObject=function(e){e.$valid&&(i.object.room_id=i.room,i.object.floor_id=i.floor,i.object.house_id=i.house,i.object.user_id=i.user,i.object.icon_id=i.icon?i.icon.id:null,i.object.template_id=i.template.id,n.create(i.object).then(function(e){r.reload()},function(){t.create("Object already exists","warning")}))}}}}]},{}],20:[function(e,o,t){"use strict";o.exports=["ObjectTemplateService","ObjectIconService","$http","ToastService","ObjectFactory",function(e,o,t,n,r){return{restrict:"E",templateUrl:"views/directives/admin-object-item.html",replace:!0,scope:{object:"=object"},link:function(t){t.ObjectTemplateService=e,t.ObjectIconService=o,t.nameEditorEnabled=!1,t.enableNameEditor=function(){t.object.category&&(t.object.template_id&&(t.template=e.getTemplate(t.object.category,t.object.template_id)),t.object.icon_id&&(t.icon=o.getIcon(t.object.category,t.object.icon_id))),t.nameEditorEnabled=!0},t.disableNameEditor=function(){t.nameEditorEnabled=!1},t.saveObject=function(e){e.$valid&&(t.object.icon_id=t.icon?t.icon.id:null,t.object.template_id=t.template.id,r.update(t.object).then(function(){},function(){}))}}}}]},{}],21:[function(e,o,t){"use strict";var n=angular.module("arena");n.directive("zone",e("./zone")),n.directive("adminObjectItem",e("./admin-object-item")),n.directive("adminAddObjectItem",e("./admin-add-object-item"))},{"./admin-add-object-item":19,"./admin-object-item":20,"./zone":22}],22:[function(e,o,t){"use strict";o.exports=["ObjectIconService","$http","UserFactory","RoomFactory","FloorFactory","HouseFactory",function(e,o,t,n,r,i){return{restrict:"E",templateUrl:"views/directives/zone.html",replace:!0,scope:{type:"@type",zone:"@zone",item:"=item",floor:"=floor",orderBar:"=orderBar"},link:function(o){switch(o.zone){case"houses":o.link="#/house/"+o.item.id;break;case"floors":o.link="#/floor/"+o.item.id;break;case"rooms":o.link="#/room/"+o.item.id}o.nameEditorEnabled=!1,o.iconEditorEnabled=!1,o.ObjectIconService=e,o.enableNameEditor=function(){o.zoneName=o.item.name,o.nameEditorEnabled=!0},o.enableIconEditor=function(){if(o.iconsArray=e.getIcons(o.zone),o.item.icon_id){var t=_.findLastIndex(o.iconsArray,{id:o.item.icon_id});o.selectedIcon=o.iconsArray[t]}o.editorIconEnabled=!0},o.saveZone=function(e){if(e.$valid)switch(o.selectedIcon&&(o.item.icon_id=o.selectedIcon.id),e.zoneName&&(o.item.name=e.zoneName.$modelValue),o.zone){case"rooms":n.update(o.item).then(function(){o.disableEditor()},function(){o.disableEditor()});break;case"floors":r.update(o.item).then(function(){o.disableEditor()},function(){o.disableEditor()});break;case"houses":i.update(o.item).then(function(){o.disableEditor()},function(){o.disableEditor()})}},o.disableEditor=function(){o.nameEditorEnabled=!1,o.editorIconEnabled=!1}}}}]},{}],23:[function(e,o,t){"use strict";o.exports=["$http","$q","ToastService",function(e,o,t){return{search:function(n){var r=o.defer();return e.post("/floors/search",n).then(function(e){r.resolve(e.data)},function(e){t.create(e.data,"danger"),r.reject(null)}),r.promise},create:function(n){var r=o.defer();return e.post("/floors/create",n).then(function(e){r.resolve(e.data[0])},function(e){t.create(e.data,"danger"),r.reject(null)}),r.promise},update:function(t){var n=o.defer();return e.put("/floors/update/"+t.id,{floor:t}).then(function(e){n.resolve(e.data)},function(){n.reject(null)}),n.promise},"delete":function(n){var r=o.defer();return e.post("/floors/delete",n).then(function(e){r.resolve(null)},function(e){t.create(e.data,"danger"),r.reject(null)}),r.promise}}}]},{}],24:[function(e,o,t){"use strict";o.exports=["$http","$q","ToastService",function(e,o,t){return{search:function(n){var r=o.defer();return e.post("/houses/search",n).then(function(e){r.resolve(e.data)},function(e){t.create(e.data,"danger"),r.reject(null)}),r.promise},create:function(n){var r=o.defer();return e.post("/houses/create",n).then(function(e){r.resolve(e.data[0])},function(e){t.create(e.data,"danger"),r.reject(null)}),r.promise},update:function(t){var n=o.defer();return e.put("/houses/update/"+t.id,{house:t}).then(function(e){n.resolve(e.data)},function(){n.reject(null)}),n.promise},"delete":function(t){var n=o.defer();return e.post("/houses/delete",t).then(function(e){n.resolve(null)},function(e){n.reject(null)}),n.promise}}}]},{}],25:[function(e,o,t){"use strict";o.exports=["ToastService","$http","RoomFactory","FloorFactory","HouseFactory","ObjectFactory","$q",function(e,o,t,n,r,i,s){return{deleteApTree:function(e){return i.search({user_id:e}).then(function(o){return i.deleteAll(o).then(function(o){return t.search({user_id:e}).then(function(e){return t.deleteAll(e).then(function(e){return!0})})})})},getApTree:function(o){return t.search({user_id:o}).then(function(e){var t={};return t.name="Apartment",t.eachConfig={group:{name:"objs",pull:!1,put:!0},onAdd:function(e){var n=e.model;n.room_id=0,n.floor_id=0,n.house_id=0,n.user_id=o,i.create(n).then(function(e){n.id=e},function(){var e=_.findLastIndex(t.objects,{id:n.id});t.objects.splice(e,1)})}},i.search({user_id:o,room_id:0,floor_id:0,house_id:0}).then(function(n){t.objects=n;var r=[];return _.each(e,function(e){e.eachConfig={group:{name:"objs",pull:!1,put:!0},onAdd:function(t){var n=t.model;n.user_id=o,n.room_id=e.id,n.floor_id=0,n.house_id=0,i.create(n).then(function(e){n.id=e},function(){var o=_.findLastIndex(e.objects,{id:n.id});e.objects.splice(o,1)})}},i.search({user_id:o,room_id:e.id,floor_id:0,house_id:0}).then(function(o){e.objects=o}),r.push(e)}),t.rooms=r,t})},function(o){e.create(o,"danger")})},getHouseTree:function(o){return n.search({user_id:o}).then(function(n){var r={};r.name="House",r.eachConfig={group:{name:"objs",pull:!1,put:!0},onAdd:function(e){var t=e.model;t.user_id=o,t.room_id=0,t.floor_id=0,t.house_id=0,i.create(t).then(function(e){t.id=e},function(){var e=_.findLastIndex(r.objects,{id:t.id});r.objects.splice(e,1)})}},i.search({user_id:o,room_id:0,floor_id:0,house_id:0}).then(function(e){r.objects=e});var s=n;return _.each(s,function(n){n.eachConfig={group:{name:"objs",pull:!1,put:!0},onAdd:function(e){var t=e.model;t.user_id=o,t.room_id=0,t.floor_id=n.id,t.house_id=0,i.create(t).then(function(e){t.id=e},function(){var e=_.findLastIndex(n.objects,{id:t.id});n.objects.splice(e,1)})}},i.search({user_id:o,room_id:0,floor_id:n.id,house_id:0}).then(function(e){n.objects=e}),n.rooms=[],t.search({user_id:o,floor_id:n.id}).then(function(e){_.each(e,function(e){e.eachConfig={group:{name:"objs",
pull:!1,put:!0},onAdd:function(t){var r=t.model;r.house_id=0,r.floor_id=n.id,r.room_id=e.id,r.user_id=o,i.create(r).then(function(e){r.id=e},function(){var o=_.findLastIndex(e.objects,{id:r.id});e.objects.splice(o,1)})}},i.search({user_id:o,room_id:e.id,floor_id:n.id,house_id:0}).then(function(o){e.objects=o}),n.rooms.push(e)})},function(o){e.create(o,"danger")})}),r.floors=s,r},function(o){e.create(o,"danger")})},getComplexTree:function(o){return r.search({user_id:o}).then(function(r){var s={};s.name="Complex",s.eachConfig={group:{name:"objs",pull:!1,put:!0},onAdd:function(e){var t=e.model;t.room_id=0,t.floor_id=0,t.house_id=0,t.user_id=o,i.create(t).then(function(e){t.id=e},function(){var e=_.findLastIndex(s.objects,{id:t.id});s.objects.splice(e,1)})}},i.search({user_id:o,room_id:0,floor_id:0,house_id:0}).then(function(e){s.objects=e});var u=r;return _.each(u,function(r){r.eachConfig={group:{name:"objs",pull:!1,put:!0},onAdd:function(e){var t=e.model;t.house_id=r.id,t.floor_id=0,t.room_id=0,t.user_id=o,i.create(t).then(function(e){t.id=e},function(){var e=_.findLastIndex(r.objects,{id:t.id});r.objects.splice(e,1)})}},i.search({user_id:o,room_id:0,floor_id:0,house_id:r.id}).then(function(e){r.objects=e}),n.search({user_id:o,house_id:r.id}).then(function(n){r.floors=n,_.each(r.floors,function(n){n.eachConfig={group:{name:"objs",pull:!1,put:!0},onAdd:function(e){var t=e.model;t.house_id=r.id,t.floor_id=n.id,t.room_id=0,t.user_id=o,i.create(t).then(function(e){t.id=e},function(){var e=_.findLastIndex(n.objects,{id:t.id});n.objects.splice(e,1)})}},i.search({user_id:o,room_id:0,floor_id:n.id,house_id:r.id}).then(function(e){n.objects=e}),n.rooms=[],t.search({user_id:o,floor_id:n.id}).then(function(e){_.each(e,function(e){e.eachConfig={group:{name:"objs",pull:!1,put:!0},onAdd:function(t){var s=t.model;s.house_id=r.id,s.floor_id=n.id,s.room_id=e.id,s.user_id=o,i.create(s).then(function(e){s.id=e},function(){var o=_.findLastIndex(e.objects,{id:s.id});e.objects.splice(o,1)})}},i.search({user_id:o,room_id:e.id,floor_id:n.id,house_id:r.id}).then(function(o){e.objects=o}),n.rooms.push(e)})},function(o){e.create(o.data,"danger")})})},function(o){e.create(o,"danger")})}),s.houses=u,s},function(o){e.create(o.data,"danger")})},getTemplate:function(t){return o.get("/api/templates/"+t).then(function(e){return e.data},function(o){e.create(o.data,"danger")})},getTemplates:function(){return o.get("/api/templates").then(function(e){return e.data},function(o){e.create(o.data,"danger")})}}}]},{}],26:[function(e,o,t){"use strict";o.exports=["$http","$q","ToastService","CookiesService",function(e,o,t,n){return{getByToken:function(){var t=o.defer();return e.get("/objects/getByToken/"+n.get("token")).then(function(e){e.data.status?t.resolve(e.data.objects):t.reject(null)},function(){t.reject(null)}),t.promise},search:function(t){var n=o.defer();return e.post("/objects/search",t).then(function(e){n.resolve(e.data)},function(){n.reject(null)}),n.promise},create:function(t){var n=o.defer();return e.post("/objects/create",{object:t}).then(function(e){n.resolve(e.data)},function(){n.reject(null)}),n.promise},createAll:function(t,n,r){var i=t.map(function(t){var i=o.defer(),s={};return s.ModuleItem=t.ModuleItem,s.ModuleType=t.ModuleType,s.ItemDescription=t.ItemDescription,s.favorite=t.favorite,s.category=t.category,s.template_id=t.template_id,s.icon_id=t.icon_id,s.detector_output=t.detector_output,s.shutter_input=t.shutter_input,s.shutter_seconds=t.shutter_seconds,s.dimming_input=t.dimming_input,s.dimming_ratio=t.dimming_ratio,s.name=t.name,s.room_id=r?r:t.room_id?t.room_id:0,s.floor_id=t.floor_id?t.floor_id:0,s.house_id=t.house_id?t.house_id:0,s.user_id=n,e.post("/objects/create",{object:s}).then(function(e){i.resolve(null)},function(){i.resolve(null)}),i.promise});return o.all(i)},update:function(t){var n=o.defer();return e.put("/objects/update/"+t.id,{object:t}).then(function(e){n.resolve(e.data)},function(){n.reject(null)}),n.promise},"delete":function(n){var r=o.defer();return e["delete"]("/objects/delete/"+n).then(function(e){r.resolve(null)},function(e){t.create(e.data,"danger"),r.reject(null)}),r.promise},deleteAll:function(t){var n=t.map(function(t){var n=o.defer();return e["delete"]("/objects/delete/"+t.id).then(function(){n.resolve(null)},function(e){n.reject(null)}),n.promise});return o.all(n)}}}]},{}],27:[function(e,o,t){"use strict";o.exports=["$http","$q","ObjectFactory","ToastService",function(e,o,t,n){return{search:function(t){var r=o.defer();return e.post("/rooms/search",t).then(function(e){r.resolve(e.data)},function(e){n.create(e.data,"danger"),r.reject(null)}),r.promise},create:function(t){var r=o.defer();return e.post("/rooms/create",t).then(function(e){r.resolve(e.data[0])},function(e){n.create(e.data,"danger"),r.reject(null)}),r.promise},createAll:function(n,r){var i=n.map(function(n){var i=o.defer(),s={};return s.user_id=r,s.name=n.name,s.floor_id=n.floor_id,s.order=n.order,s.icon_id=n.icon_id,e.post("/rooms/create",s).then(function(e){var o=parseInt(e.data);t.createAll(n.objects,r,o).then(function(){i.resolve(e.data[0])})},function(e){i.resolve(null)}),i.promise});return o.all(i)},update:function(t){var n=o.defer();return e.put("/rooms/update/"+t.id,{room:t}).then(function(e){n.resolve(e.data)},function(){n.reject(null)}),n.promise},"delete":function(t){var r=o.defer();return e.post("/rooms/delete",t).then(function(e){r.resolve(null)},function(e){n.create(e.data,"danger"),r.reject(null)}),r.promise},deleteAll:function(t){var n=t.map(function(t){var n=o.defer();return t.room_id=t.id,e.post("/rooms/delete",t).then(function(){n.resolve(null)},function(e){n.reject(null)}),n.promise});return o.all(n)}}}]},{}],28:[function(e,o,t){"use strict";o.exports=["$http","$q","ToastService",function(e,o,t){return{login:function(n){var r=o.defer();return e.get("/users/login/"+n.name+"/"+n.password).then(function(e){r.resolve(e.data)},function(e){t.create(e.data,"danger"),r.reject(null)}),r.promise},all:function(){var t=o.defer();return e.get("/users/all").then(function(e){t.resolve(e.data)},function(e){t.reject(null)}),t.promise},find:function(t){var n=o.defer();return e.get("/users/find/"+t).then(function(e){n.resolve(e.data)},function(e){n.reject(null)}),n.promise},logout:function(){var t=o.defer();return e.get("/users/logout").then(function(){t.resolve(null)},function(e){t.reject(null)}),t.promise},"delete":function(n){var r=o.defer();return e["delete"]("/users/delete/"+n).then(function(){r.resolve(null)},function(e){t.create(e.data,"danger")}),r.promise},create:function(n){var r=o.defer();return e.post("/users/create",{user:n}).then(function(e){r.resolve(e.data[0])},function(e){t.create(e.data,"danger")}),r.promise}}}]},{}],29:[function(e,o,t){"use strict";var n=angular.module("arena");n.factory("UserFactory",e("./UserFactory")),n.factory("ObjectFactory",e("./ObjectFactory")),n.factory("RoomFactory",e("./RoomFactory")),n.factory("FloorFactory",e("./FloorFactory")),n.factory("HouseFactory",e("./HouseFactory")),n.factory("ItemFactory",e("./ItemFactory"))},{"./FloorFactory":23,"./HouseFactory":24,"./ItemFactory":25,"./ObjectFactory":26,"./RoomFactory":27,"./UserFactory":28}],30:[function(e,o,t){"use strict";var n=angular.module("arena",["ngRoute","ngResource","ngCookies","ngSanitize","ngAnimate","ngTouch","ng-sortable","ngToast","ui.bootstrap","angular-svg-round-progress","rzModule","hmTouchEvents"]);e("./controllers"),e("./directives"),e("./services"),e("./factories"),n.config(["$routeProvider","ngToastProvider",function(e,o){e.when("/",{templateUrl:"./views/login.html",controller:"loginCtrl"}),e.when("/sessions",{templateUrl:"./views/sessions.html",controller:"sessionsCtrl"}),e.when("/wizzard/users",{templateUrl:"./views/wizzard/users.html",controller:"usersCtrl",resolve:{users:["UserFactory",function(e){return e.all().then(function(e){return e},function(){})}]}}),e.when("/wizzard/rooms-to-house/:userid/:type",{templateUrl:"./views/wizzard/rooms-to-house.html",controller:"roomsToHouseCtrl",resolve:{user:["$route","UserFactory",function(e,o){return o.find(e.current.params.userid).then(function(e){return e})}],items:["$route","ItemFactory",function(e,o){switch(e.current.params.type){case"ap":return o.getApTree(e.current.params.userid).then(function(e){return e});case"house":return o.getHouseTree(e.current.params.userid).then(function(e){return e});case"complex":return o.getComplexTree(e.current.params.userid).then(function(e){return e})}}]}}),e.when("/wizzard/objects-to-rooms/:userid/:type",{templateUrl:"./views/wizzard/objects-to-rooms.html",controller:"objectsToRoomsCtrl",resolve:{user:["$route","UserFactory",function(e,o){return o.find(e.current.params.userid).then(function(e){return e})}],objects:["$http","ObjectFactory",function(e,o){return o.getByToken().then(function(e){return e})}],items:["$route","ItemFactory",function(e,o){switch(e.current.params.type){case"ap":return o.getApTree(e.current.params.userid).then(function(e){return e});case"house":return o.getHouseTree(e.current.params.userid).then(function(e){return e});case"complex":return o.getComplexTree(e.current.params.userid).then(function(e){return e})}}]}}),e.when("/wizzard/objects-controlls/:userid/:type",{templateUrl:"./views/wizzard/objects-controlls.html",controller:"objectsControllsCtrl",resolve:{user:["$route","UserFactory",function(e,o){return o.find(e.current.params.userid).then(function(e){return e})}],items:["$route","ItemFactory",function(e,o){switch(e.current.params.type){case"ap":return o.getApTree(e.current.params.userid).then(function(e){return e});case"house":return o.getHouseTree(e.current.params.userid).then(function(e){return e});case"complex":return o.getComplexTree(e.current.params.userid).then(function(e){return e})}}]}}),e.when("/wizzard/objects",{templateUrl:"./views/wizzard/objects.html",controller:"objectsCtrl"}),e.otherwise({resolve:{config:["configSrv","$route","$location",function(o,t,n){o.getConfigAndGenerateRoutes(e).then(function(e){t.reload()},function(e){n.path("/")})}]}}),o.configure({verticalPosition:"top",horizontalPosition:"center",animation:"fade",maxNumber:1})}]),n.run(["$rootScope","$location","AuthentificationService","TranslateService","$http","$window",function(e,o,t,n,r,i){e.$on("$routeChangeStart",function(e,n,r){"/"==o.$$path&&t.isAdmin()&&o.path("/wizzard/users"),"/"==o.$$path&&t.isLoggedIn()&&o.path("/start"),t.isLoggedIn()||o.path("/")})}]),function(e,o,t){var r=function(e,o){n.directive(t.camelCase("bat-object-"+e),["$window","$rootScope","ObjectIconService",function(t,n,r){return{restrict:"E",scope:{item:"=",room:"@",type:"@",items:"=",setfavorite:"="},template:'<div ng-include="templateUrl"></div>',controller:o,link:function(o){o.templateUrl="./objects/templates/"+o.item.category+"/"+e+".html",o.ObjectIconService=r,o.removeFavorite=function(e){var t=_.findLastIndex(o.items,{$$hashKey:e.$$hashKey});o.items.splice(t,1)},o.setFavorite=function(e){o.item.favorite=e,o.item.live.updateObject(o.item).then(function(e){},function(){o.item.favorite=!o.item.favorite})},o.editorNameEnabled=!1,o.editorIconEnabled=!1,o.enableNameEditor=function(){o.editableText=o.item.name,o.editorNameEnabled=!0},o.enableIconEditor=function(){if(o.item.live.$$service.stop(),o.iconsArray=r.getIcons(o.item.category),o.item.icon_id){var e=_.findLastIndex(o.iconsArray,{id:o.item.icon_id});o.selectedIcon=o.iconsArray[e]}o.editorIconEnabled=!0},o.disableEditor=function(){o.editorNameEnabled=!1,o.editorIconEnabled=!1,o.item.live.$$service.start()},o.saveIcon=function(e){e.$valid&&(o.item.icon_id=e.selectedIcon.$modelValue.id,o.item.live.updateObject(o.item).then(function(e){o.disableEditor()},function(){o.disableEditor()}))},o.saveName=function(e){e.$valid&&(o.item.name=e.editableText.$modelValue,o.item.live.updateObject(o.item).then(function(e){o.disableEditor()}))}}}}])};n.directive("batObject",["$compile","ObjectTemplateService",function(e,o){return{restrict:"E",scope:{item:"=",room:"@",type:"@",items:"=",setfavorite:"="},link:function(t,n,r){if(t.item.category&&t.item.template_id){var i=o.getTemplate(t.item.category,t.item.template_id),i=i.name?i.name:null,s="bat-object-"+i,u=(t.room,"<"+s+' item="item" items="items" room="{{room}}" type="{{type}}" setfavorite="setfavorite"></'+s+">");n.html(u),e(n.contents())(t)}}}}]),r("light-switch-with-one-button",["$scope",function(e){e.onChange=function(){e.item.live.setValue(parseInt(e.item.live.ModuleValue))}}]),r("light-switch-with-two-buttons",["$scope",function(e){e.onChange=function(o){e.item.live.setValue(o)}}]),r("light-dimming-two-buttons",["$scope",function(e){e.onChange=function(o){var t=parseInt(e.item.live.ModuleValue);"up"==o?t+=e.item.ratio?e.item.ratio:10:t-=e.item.ratio?e.item.ratio:10,t=t>100?100:0>t?0:t,e.item.live.setValue(t)}}]),r("light-dimming-with-slider",["$scope","$timeout","$interval",function(e,o,t){e.slider={value:0,options:{floor:0,ceil:100,onEnd:function(){e.item.live.setValue(e.slider.value)}}},e.$watch(function(){return e.item.live.ModuleValue},function(o){e.slider.value=o})}]),r("light-dimming-with-or-without-memory",["$scope","batApiSrv",function(e,o){var t,n={};e.item.dimming_input&&(t=e.item.dimming_input.replace(/[0-9]/g,"")),n.HAModuleId=e.item.HAModuleId,n.ModuleItem=e.item.dimming_input,n.ModuleType=t,n.ModuleValue="1";var r={};r.button="Left",e.onPress=function(){r.mouseState="Down",o.setHelpModuleValue(n,r)},e.onPressUp=function(){r.mouseState="Up",o.setHelpModuleValue(n,r)},e.onTap=function(){r.mouseState="Down",o.setHelpModuleValue(n,r).then(function(){r.mouseState="Up",o.setHelpModuleValue(n,r)})},e.slider={value:0,options:{floor:0,ceil:100,onEnd:function(){e.item.live.setValue(e.slider.value)}}},e.$watch(function(){return e.item.live.ModuleValue},function(o){e.slider.value=o})}]),r("scenario-one",["$scope","$timeout",function(e,o){e.onChange=function(){var t={};e.loading=!1,t.button="Left",t.mouseState="Down",e.item.live.setValue(1,t).then(function(){e.loading=!0,o(function(){t.mouseState="Up",e.item.live.setValue(1,t).then(function(){e.loading=!1})},2e3)})}}]),r("heating-one",["$scope","batApiSrv",function(e,o){var t={};t.HAModuleId=e.item.HAModuleId,t.ModuleType=e.item.ModuleType,t.ModuleItem="Instruction",o.getHelpModuleValue(t).then(function(o){void 0==o.ModuleValue?e.item.setpoint=20:e.item.setpoint=parseFloat(o.ModuleValue)}),e.onChange=function(n){var r=e.item.setpoint,i=r;i=parseFloat(i).toFixed(1),"up"==n?35>r&&(i=Number(i)+Number(.2)):r>15&&(i=Number(i)-Number(.2)),i=parseFloat(i).toFixed(1),t.ModuleValue=i,o.setHelpModuleValue(t,{}).then(function(o){e.item.setpoint=i},function(){e.item.setpoint=r})}}]),r("shutters-one",["$scope","$timeout","batApiSrv",function(e,o,t){e.goingDown=!1,e.goingUp=!1;var n,r=e.item.shutter_seconds?e.item.shutter_seconds:10;e.up=function(){var t={};t.button="Left",t.mouseState="Down",e.item.live.setValue("1",t).then(function(i){t.button="Left",t.mouseState="Up",e.item.live.setValue("1",t).then(function(t){n=o(function(){e.goingUp=!1,e.goingDown=!1},1e3*r)})})},e.down=function(){var i={};i.button="Left",i.mouseState="Down";var s={};s.HAModuleId=e.item.HAModuleId,s.ModuleItem=e.item.shutter_input,s.ModuleType=e.item.ModuleType,s.ModuleValue="1",t.setHelpModuleValue(s,i).then(function(u){i.button="Left",i.mouseState="Up",t.setHelpModuleValue(s,i).then(function(t){n=o(function(){e.goingUp=!1,e.goingDown=!1},1e3*r)})})},e.onStop=function(t){o.cancel(n),e.goingUp=!1,e.goingDown=!1,"up"==t?e.up():e.down()},e.onMove=function(t){switch(o.cancel(n),t){case"up":e.goingUp=!0,e.goingDown=!1;break;case"down":e.goingDown=!0,e.goingUp=!1;break;default:e.goingUp=!1,e.goingDown=!1}"up"==t?e.up():e.down()}}]),r("magnetic-contactor",["$scope",function(e){}]),r("flood-detector",["$scope",function(e){}]),r("door-yale",["$scope","$timeout",function(e,o){e.loading=!1,e.onChange=function(){e.loading=!0,e.item.live.setValue(100).then(function(){o(function(){e.item.live.setValue(0).then(function(){e.loading=!1})},2e3)})}}]),r("smoke-detector-circuit",["$scope","batApiSrv","$timeout",function(e,o,t){var n,r={};e.loading=!1,e.item.detector_output&&(n=e.item.detector_output.replace(/[0-9]/g,"")),r.HAModuleId=e.item.HAModuleId,r.ModuleItem=e.item.detector_output,r.ModuleType=n,e.onChange=function(){e.loading=!0,r.ModuleValue=0,o.setHelpModuleValue(r).then(function(n){r.ModuleValue=100,t(function(){o.setHelpModuleValue(r).then(function(o){e.loading=!1})},1e3)})}}])}(angular,window,$)},{"./controllers":5,"./directives":21,"./factories":29,"./services":41}],31:[function(e,o,t){"use strict";o.exports=["CookiesService","$q","$http","$location","ToastService","UserFactory",function(e,o,t,n,r,i){var s=function(o,t){e.put(o,t)},u=function(){e.remove("user"),e.remove("user_id"),e.remove("token"),e.remove("type"),e.remove("language")};return{login:function(e){var t=o.defer();return i.login(e).then(function(e){s("token",e.token),s("user_id",e.user.id),s("user",e.user.name),s("type",e.user.type),t.resolve(null)},function(e){t.reject(null)}),t.promise},logout:function(){i.logout().then(function(){u(),n.path("/")})},isLoggedIn:function(){return e.get("token")},isAdmin:function(){return e.get("token")&&"admin@admin.com"==e.get("user")}}}]},{}],32:[function(e,o,t){"use strict";o.exports=["$cookies",function(e){window.localStorage;return{get:function(o){return e.get(o)},put:function(o,t){var n=new Date;return n.setDate(n.getDate()+365),e.put(o,t,{expires:n}),t},remove:function(o){return e.remove(o)}}}]},{}],33:[function(e,o,t){"use strict";o.exports=function(){var e={};return e.L=[],e.RM=[],e.H=[],e.SC=[],e.SE=[],e.houses=[],e.floors=[],e.rooms=[],e.L.push({id:1,name:"lights-01",type:"icon"}),e.L.push({id:2,name:"lights-02",type:"icon"}),e.L.push({id:3,name:"lights-03",type:"icon"}),e.L.push({id:4,name:"lights-04",type:"icon"}),e.L.push({id:5,name:"lights-05",type:"icon"}),e.L.push({id:6,name:"lights-06",type:"icon"}),e.L.push({id:7,name:"lights-07",type:"icon"}),e.L.push({id:8,name:"lights-08",type:"icon"}),e.L.push({id:9,name:"lights-09",type:"icon"}),e.L.push({id:10,name:"lights-10",type:"icon"}),e.L.push({id:11,name:"lights-11",type:"icon"}),e.L.push({id:12,name:"lights-12",type:"icon"}),e.L.push({id:13,name:"fa fa-battery-half",type:"progress-bar-horisontal-01"}),e.L.push({id:14,name:"fa fa-circle-o-notch",type:"progress-round-01"}),e.RM.push({id:1,name:"fa fa-bars"}),e.SC.push({id:1,name:"fa fa-power-off"}),e.SC.push({id:2,name:"fa fa-television"}),e.SC.push({id:3,name:"fa fa-volume-up"}),e.SC.push({id:4,name:"fa fa-volume-off"}),e.SC.push({id:5,name:"fa fa-bell"}),e.SC.push({id:6,name:"fa fa-bell-slash"}),e.SC.push({id:7,name:"fa fa-circle"}),e.SC.push({id:8,name:"fa fa-check-circle"}),e.SC.push({id:9,name:"fa fa-toggle-on"}),e.SC.push({id:10,name:"fa fa-toggle-off"}),e.SC.push({id:11,name:"fa fa-bed"}),e.SE.push({id:1,name:"fa fa-fire"}),e.SE.push({id:2,name:"fa fa-tint"}),e.SE.push({id:3,name:"contactors-window-1"}),e.SE.push({id:4,name:"contactors-door-1"}),e.houses.push({id:1,name:"houses-01",human:"human"}),e.houses.push({id:2,name:"houses-02",human:"human"}),e.houses.push({id:3,name:"houses-03",human:"human"}),e.houses.push({id:4,name:"houses-04",human:"human"}),e.floors.push({id:1,name:"floors-01",human:"human"}),e.floors.push({id:2,name:"floors-02",human:"human"}),e.floors.push({id:3,name:"floors-03",human:"human"}),e.floors.push({id:4,name:"floors-04",human:"human"}),e.floors.push({id:5,name:"floors-05",human:"human"}),e.floorsAll=[],e.floorsAll.push({id:1,name:"floors-all-2",human:"For 2 stories building"}),e.floorsAll.push({id:2,name:"floors-all-3",human:"For 3 stories building"}),e.rooms.push({id:1,name:"rooms-01",human:"room"}),e.rooms.push({id:2,name:"rooms-02",human:"room"}),e.rooms.push({id:4,name:"rooms-04",human:"room"}),e.rooms.push({id:5,name:"rooms-05",human:"room"}),e.rooms.push({id:6,name:"rooms-06",human:"room"}),e.rooms.push({id:7,name:"rooms-07",human:"room"}),e.rooms.push({id:8,name:"rooms-08",human:"room"}),e.rooms.push({id:9,name:"rooms-09",human:"room"}),e.rooms.push({id:10,name:"rooms-10",human:"room"}),e.rooms.push({id:11,name:"rooms-11",human:"room"}),{getIcons:function(o){return e[o]},getIcon:function(o,t){if(o){var n=_.findLastIndex(e[o],{id:t});return e[o][n]}}}}},{}],34:[function(e,o,t){"use strict";o.exports=function(){var e={};return e.L=[],e.CM=[],e.RM=[],e.H=[],e.SC=[],e.SE=[],e.L.push({id:1,name:"light-switch-with-one-button",human:"Light switch with one button"}),e.L.push({id:2,name:"light-switch-with-two-buttons",human:"Lights switch with 2 buttons"}),e.L.push({id:3,name:"light-dimming-two-buttons",human:"Dimmer with 2 buttons"}),e.L.push({id:4,name:"light-dimming-with-slider",human:"Dimmer with slider"}),e.L.push({id:5,name:"light-dimming-with-or-without-memory",human:"Dimmer with or without memory"}),e.RM.push({id:1,name:"shutters-one",human:"Shutters with 2 buttons"}),e.H.push({id:1,name:"heating-one",human:"Heating control with 2 buttons"}),e.SC.push({id:1,name:"scenario-one",human:"Scenario with one set/reset"}),e.SE.push({id:1,name:"smoke-detector-circuit",human:"Smoke detector with reset circuit"}),e.SE.push({id:2,name:"flood-detector",human:"Flood detector"}),e.SE.push({id:3,name:"door-yale",human:"Door yale"}),e.SE.push({id:4,name:"magnetic-contactor",human:"Magentic contactors"}),{getTemplates:function(o){return e[o]},getTemplate:function(o,t){var n=_.findLastIndex(e[o],{id:t});return e[o][n]}}}},{}],35:[function(e,o,t){"use strict";o.exports=["ngToast",function(e){return{create:function(o,t){e.create({className:t,content:o,dismissButton:!0,dismissButtonHtml:"&times;"})}}}]},{}],36:[function(e,o,t){"use strict";o.exports=function(){var e=[];return{get:function(o){return e[o]},set:function(o,t){return e[o]=t}}}},{}],37:[function(e,o,t){"use strict";o.exports=function(){var e=[];return e[200]="wi wi-thunderstorm",e[201]="wi wi-thunderstorm",e[202]="wi wi-thunderstorm",e[210]="wi wi-thunderstorm",e[211]="wi wi-thunderstorm",e[212]="wi wi-thunderstorm",e[221]="wi wi-thunderstorm",e[230]="wi wi-thunderstorm",e[231]="wi wi-thunderstorm",e[232]="wi wi-thunderstorm",e[300]="wi wi-showers",e[301]="wi wi-showers",e[302]="wi wi-showers",e[310]="wi wi-showers",e[311]="wi wi-showers",e[312]="wi wi-showers",e[313]="wi wi-showers",e[314]="wi wi-showers",e[321]="wi wi-showers",e[500]="wi wi-showers",e[501]="wi wi-showers",e[502]="wi wi-showers",e[503]="wi wi-showers",e[504]="wi wi-showers",e[511]="wi wi-snow",e[520]="wi wi-rain",e[521]="wi wi-rain",e[522]="wi wi-rain",e[531]="wi wi-rain",e[600]="wi wi-snow",e[601]="wi wi-snow",e[602]="wi wi-snow",e[611]="wi wi-snow",e[612]="wi wi-snow",e[615]="wi wi-snow",e[616]="wi wi-snow",e[620]="wi wi-snow",e[621]="wi wi-snow",e[622]="wi wi-snow",e[701]="wi wi-fog",e[711]="wi wi-fog",e[721]="wi wi-fog",e[731]="wi wi-fog",e[741]="wi wi-fog",e[751]="wi wi-fog",e[761]="wi wi-fog",e[762]="wi wi-fog",e[771]="wi wi-fog",e[781]="wi wi-fog",e[800]="wi wi-day-sunny",e[801]="wi wi-day-cloudy",e[802]="wi wi-cloudy",e[803]="wi wi-cloudy",e[804]="wi wi-cloudy",{getIcon:function(o){return e[o]},getMock:function(){return e[200]}}}},{}],38:[function(e,o,t){"use strict";o.exports=["$http","$q","$interval","CookiesService","$timeout","UserFactory","ObjectFactory",function(e,o,t,n,r,i,s){var u=function(e,o){this.id=e.id,this.ModuleValue=void 0==e.ModuleValue?0:e.ModuleValue,this.HAModuleId=e.HAModuleId,this.ModuleItem=e.ModuleItem,this.ModuleType=e.ModuleType,this.ts=(new Date).getTime(),this.$$service=o};u.prototype.update=function(e){(e.ts>this.ts||!this.ts)&&this.ModuleValue!=e.ModuleValue&&(this.ModuleValue=e.ModuleValue,this.ts=(new Date).getTime())},u.prototype.setValue=function(e,t){var n=o.defer(),i=this;return void 0==t&&(t={},t.button=void 0,t.mouseState=void 0),this.$$service.stop(),this.ModuleValue=e,this.ts=(new Date).getTime(),this.$$service.setModulesValue(this,t).then(function(e){r(function(){i.$$service.start()},1e3),n.resolve(e)}),n.promise},u.prototype.updateObject=function(e){var t=o.defer();return s.update(e).then(function(e){t.resolve(null)},function(e){t.reject(null)}),t.promise};var c=function(){this.liveObjects=[],this.liveObjectsIndex={},this._watcherHandle=null,this._lastTimestamp=null,this.status=null};c.prototype.getLiveObject=function(e){if("object"==typeof e){if(this.liveObjectsIndex[e.id])return this.liveObjectsIndex[e.id];var o=new u(e,this);return this._addLiveObject(o),o}return this.liveObjectsIndex[e]},c.prototype.getLiveList=function(e){var o=this;return angular.forEach(e,function(e){e.live=o.getLiveObject(e)}),e},c.prototype.clearObjects=function(){this.liveObjects=[],this.liveObjectsIndex={}},c.prototype._addLiveObject=function(e){this.liveObjects.push(e),this.liveObjectsIndex[e.id]=e},c.prototype.setModulesValue=function(t,n){var r=o.defer();(new Date).getTime();if(void 0==n){n={};var i=void 0,s=void 0}else var i=n.button,s=n.mouseState;return e.get("/helpers/setModulesValue/"+t.id+"/"+t.ModuleValue+"/"+i+"/"+s).success(function(e){e.status?r.resolve(!0):r.resolve(!1)}).error(function(e){r.resolve(!1)}),r.promise},c.prototype.setHelpModuleValue=function(t,n){var r=o.defer();if(void 0==n){n={};var i=void 0,s=void 0}else var i=n.button,s=n.mouseState;return e.get("/helpers/setHelpModuleValue/"+t.HAModuleId+"/"+t.ModuleItem+"/"+t.ModuleType+"/"+t.ModuleValue+"/"+i+"/"+s).success(function(e){e.status?r.resolve(null):r.reject(null)}).error(function(e){r.resolve(!1)}),r.promise},c.prototype.getHelpModuleValue=function(t){var n=o.defer();return e.get("/helpers/getHelpModuleValue/"+t.HAModuleId+"/"+t.ModuleType+"/"+t.ModuleItem).success(function(e){e.status?n.resolve(e.object):n.reject(null)}).error(function(e){n.reject(null)}),n.promise},c.prototype.updateModule=function(){for(var t=this,n=o.defer(),r=Object.keys(this.liveObjects),i=[],s=0;s<r.length;s++)i.push(this.liveObjects[r[s]].id);if(r=i.join(","),0==r.length)n.resolve(null);else{var u=Date.now();e.get("/helpers/GetModuleValuesByToken/"+r).success(function(e){if(e.status)for(var o in e.objects){var r=e.objects[o];r.id=r.id;var i=t.getLiveObject(r);r.ts=u,i.update(r)}n.resolve(null)}).error(function(e){n.resolve(null)})}return n.promise},c.prototype._watcherFn=function(){if(!this._processRunning){var e=this;this._processRunning=!0,this.updateModule().then(function(){e._processRunning=!1})}},c.prototype.start=function(){if(this._watcherHandle)return!1;var e=this;return this._watcherHandle=t(function(){e._watcherFn()},1e3),!0},c.prototype.stop=function(){if(this._watcherHandle){var e=t.cancel(this._watcherHandle);return this._watcherHandle=null,e}return!1};var a=new c;return a.start(),a}]},{}],39:[function(e,o,t){"use strict";o.exports=["$http","TranslateService","CookiesService",function(e,o,t){var n={getConfigAndGenerateRoutes:function(r){return e.get("/helpers/words").success(function(e){_.each(e,function(e,t){o.set(t,e)});var i=t.get("type");n.generateRoutes(r,i)})},generateRoutes:function(e,n){e.when("/start",{templateUrl:"./views/home.html",controller:"homeCtrl",resolve:{title:function(){return t.get("user")},objects:["UserFactory","ObjectFactory",function(e,o){return o.search({user_id:t.get("user_id"),favorite:1}).then(function(e){return e})}],type:function(){return n}}}),e.when("/tree",{templateUrl:"./views/tree.html",controller:"treeCtrl",resolve:{items:["UserFactory","RoomFactory","FloorFactory","HouseFactory",function(e,o,r,i){switch(n){case"ap":return o.search({user_id:t.get("user_id")}).then(function(e){return e});case"house":return r.search({user_id:t.get("user_id")}).then(function(e){return e});case"complex":return i.search({user_id:t.get("user_id")}).then(function(e){return e})}}],objects:["ObjectFactory",function(e){return e.search({user_id:t.get("user_id"),house_id:0,floor_id:0,room_id:0}).then(function(e){return e})}],zone:function(){switch(n){case"ap":return"rooms";case"house":return"floors";case"complex":return"houses"}},type:function(){return n},title:function(){return o.get("house_plan")}}}),e.when("/ap",{templateUrl:"./views/ap.html",controller:"apCtrl",resolve:{objects:["ObjectFactory",function(e){return e.search({user_id:t.get("user_id")}).then(function(e){return e})}],zone:function(){switch(n){case"ap":return"rooms";case"house":return"floors";case"complex":return"houses"}},title:function(){return o.get("house_plan")},type:function(){return n}}}),e.when("/house/:houseId",{templateUrl:"./views/house.html",controller:"houseCtrl",resolve:{objects:["$route","UserFactory","ObjectFactory",function(e,o,n){return n.search({user_id:t.get("user_id"),house_id:e.current.params.houseId,floor_id:0,room_id:0}).then(function(e){return e})}],floors:["$route","UserFactory","FloorFactory",function(e,o,n){return n.search({user_id:t.get("user_id"),house_id:e.current.params.houseId}).then(function(e){return e})}],house:["$route","UserFactory","HouseFactory",function(e,o,n){return n.search({user_id:t.get("user_id"),house_id:e.current.params.houseId}).then(function(e){return e[0]})}],type:function(){return n}}}),e.when("/floor/:floorId",{templateUrl:"./views/floor.html",controller:"floorCtrl",resolve:{objects:["$route","ObjectFactory",function(e,o){return o.search({user_id:t.get("user_id"),floor_id:e.current.params.floorId,room_id:0}).then(function(e){return e})}],rooms:["$route","RoomFactory",function(e,o){return o.search({user_id:t.get("user_id"),floor_id:e.current.params.floorId}).then(function(e){return e})}],floor:["$route","FloorFactory",function(e,o){return o.search({user_id:t.get("user_id"),floor_id:e.current.params.floorId}).then(function(e){return e[0]})}],type:function(){return n}}}),e.when("/room/:roomId/:typeId?",{templateUrl:"./views/room.html",controller:"roomCtrl",resolve:{objects:["$route","RoomFactory","ObjectFactory",function(e,o,n){return n.search({user_id:t.get("user_id"),room_id:e.current.params.roomId,category:e.current.params.typeId}).then(function(e){return e})}],room:["$route","UserFactory","RoomFactory",function(e,o,n){return n.search({user_id:t.get("user_id"),room_id:e.current.params.roomId}).then(function(e){return e[0]})}],type:function(){return n},typeId:["$route",function(e){return e.current.params.typeId}]}}),e.when("/settings",{templateUrl:"./views/settings.html",controller:"settingsCtrl"}),e.when("/type/:category/:houseId?/:floorId?/:roomId?",{templateUrl:function(){return"./views/type.html"},controller:"typeCtrl",resolve:{objects:["$route","UserFactory","ObjectFactory",function(e,o,n){return n.search({user_id:t.get("user_id"),category:e.current.params.category,house_id:e.current.params.houseId,floor_id:e.current.params.floorId,room_id:e.current.params.roomId}).then(function(e){return e})}],type:function(){return n},typeId:["$route",function(e){return e.current.params.category}],zones:["helperObjectService",function(e){switch(n){case"ap":return e.getApTree(t.get("user_id")).then(function(e){return e});case"house":return e.getHouseTree(t.get("user_id")).then(function(e){return e});case"complex":return e.getComplexTree(t.get("user_id")).then(function(e){return e})}}],title:["$route",function(e){return o.get(e.current.params.category)}],routes:["$route",function(e){var o={};return o.houseId=e.current.params.houseId,o.floorId=e.current.params.floorId,o.roomId=e.current.params.roomId,o}]}}),e.otherwise({redirectTo:"/start"})}};return n}]},{}],40:[function(e,o,t){"use strict";o.exports=["$q","$http","RoomFactory","FloorFactory","HouseFactory",function(e,o,t,n,r){var i=function(){};return i.prototype.reorder=function(o,i){var s=e.defer(),u=1,o=o.map(function(e){return e.order=u,u++,e});switch(i){case"complex":angular.forEach(o,function(e){r.update(e).then(function(){},function(){})});break;case"house":angular.forEach(o,function(e){n.update(e).then(function(){},function(){})});break;case"ap":angular.forEach(o,function(e){t.update(e).then(function(){},function(){})})}return s.promise},i.prototype.getComplexTree=function(o){var i=e.defer(),s={};return r.search({user_id:o}).then(function(e){s=e,_.each(e,function(e){n.search({user_id:o,house_id:e.id}).then(function(n){
e.floors=n,_.each(n,function(e){t.search({user_id:o,floor_id:e.id}).then(function(o){e.rooms=o})})})}),i.resolve(s)}),i.promise},i.prototype.getHouseTree=function(o){var r=e.defer(),i={};return n.search({user_id:o}).then(function(e){i=e,_.each(e,function(e){t.search({user_id:o,floor_id:e.id}).then(function(o){e.rooms=o})}),r.resolve(i)}),r.promise},i.prototype.getApTree=function(o){var n=e.defer(),r={};return t.search({user_id:o}).then(function(e){r=e,n.resolve(r)}),n.promise},new i}]},{}],41:[function(e,o,t){"use strict";var n=angular.module("arena");n.service("AuthentificationService",e("./AuthentificationService")),n.service("configSrv",e("./configSrv")),n.service("helperObjectService",e("./helperObjectService")),n.service("batApiSrv",e("./batApiSrv")),n.service("ObjectIconService",e("./ObjectIconService")),n.service("ObjectTemplateService",e("./ObjectTemplateService")),n.service("TranslateService",e("./TranslateService")),n.service("WeatherIconService",e("./WeatherIconService")),n.service("CookiesService",e("./CookiesService")),n.service("ToastService",e("./ToastService"))},{"./AuthentificationService":31,"./CookiesService":32,"./ObjectIconService":33,"./ObjectTemplateService":34,"./ToastService":35,"./TranslateService":36,"./WeatherIconService":37,"./batApiSrv":38,"./configSrv":39,"./helperObjectService":40}]},{},[30]);